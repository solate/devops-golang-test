

## 步骤


### 1. 初始化项目结构

[kubebuilder](https://zhuanlan.zhihu.com/p/697338036)

1. go mod init 

```
go mod init github.com/solate/devops-golang-test
```

```
kubebuilder init --domain example.com --repo github.com/solate/devops-golang-test --plugins=go/v3

kubebuilder create api --group apps --version v1 --kind MyStatefulSet 

kubebuilder create webhook --group apps --version v1 --kind MyStatefulSet --defaulting --programmatic-validation --conversion

```

#### 解决错误

{"error": "open /tmp/k8s-webhook-server/serving-certs/tls.crt: no such file or directory"}

```
mkdir -p /tmp/k8s-webhook-server/serving-certs/
cp /etc/kubernetes/pki/apiserver.crt /tmp/k8s-webhook-server/serving-certs/tls.crt
cp /etc/kubernetes/pki/apiserver.key /tmp/k8s-webhook-server/serving-certs/tls.key
```

启动
```
make install

make run
```





